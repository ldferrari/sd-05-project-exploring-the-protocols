const RESPONSE = `${[
  'HTTP/1.1 200 OK',
  'Content-Type: text/html; charset=UTF-8',
  '',
  '<h1>Protocolos</h1>',
].join('\r\n')}\r\n\r\n`;

// HTTP/1.1 302 Found
// Location: https://www.google.com.br/?gws_rd=ssl
// Cache-Control: private
// Content-Type: text/html; charset=UTF-8
// Date: Thu, 11 Mar 2021 21:06:16 GMT
// Server: gws
// Content-Length: 234
// X-XSS-Protection: 0
// X-Frame-Options: SAMEORIGIN
// Set-Cookie: 1P_JAR=2021-03-11-21;cccccoooontabaixo
// expires=Sat, 10-Apr-2021 21:06:16 GMT; path=/; domain=.google.com.br; Secure; SameSite=none

// <HTML><HEAD><meta http-equiv="content-type" content="text/html;charset=utf-8">
// <TITLE>302 Moved</TITLE></HEAD><BODY>
// <H1>302 Moved</H1>
// The document has moved
// <A HREF="https://www.google.com.br/?gws_rd=ssl">here</A>.
// </BODY></HTML>

const net = require('net');

const server = net.createServer((socket) => {
  socket.write(RESPONSE);

  socket.on('data', (data) => {
    console.log(data.toString());
  });

  socket.on('close', () => {
    console.log('connection closed');
  });

  socket.end();
  // socket.close = function(data) {
  //   var Self = this;
  //   if (data) this.write (data, function(){ Self.destroy();});
  //   else this.destroy();}
});

const PORT = 8085;

server.listen(PORT);

console.log(`Server TCP ativo!\nEscutando na porta: ${PORT}`);
